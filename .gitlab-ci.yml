stages:
  - build

build-in3:
  image: gcc
  stage: build
  tags:
    - short-jobs
  script:
    - apt-get update --yes
    - apt-get install --yes cmake
    - mkdir build
    - cd build
    - cmake ..
    - make

.xbuild:
  services:
    - docker:dind
  image: jonaskello/docker-and-compose:latest
  stage: build
  tags:
    - short-jobs
  script:
    - apk add --no-cache bash
    - docker run --rm "dockcross/$IMAGE" > ./dockcross
    - chmod +x ./dockcross
    - ./dockcross bash -c 'mkdir build; cd build; cmake ..; make  '
  variables:
     IMAGE: "linux-x64"

xbuild-linux-64:
  extends: .xbuild
  variables:
     IMAGE: linux-64

xbuild-windows-x64:
  extends: .xbuild
  variables:
     IMAGE: windows-x64

xbuild-linux-armv5:
  extends: .xbuild
  variables:
     IMAGE: linux-armv5

xbuild-linux-armv64:
  extends: .xbuild
  variables:
     IMAGE: linux-armv64

xbuild-linux-armv6:
  extends: .xbuild
  variables:
     IMAGE: linux-armv6

xbuild-linux-armv7:
  extends: .xbuild
  variables:
     IMAGE: linux-armv7

xbuild-windows-x86:
  extends: .xbuild
  variables:
     IMAGE: windows-x86

